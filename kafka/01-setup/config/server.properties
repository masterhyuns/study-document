# Kafka Server 설정 파일 예시
# 프로덕션 환경에서 사용할 수 있는 상세 설정

############################# Server Basics #############################

# 브로커 ID (클러스터 내에서 고유해야 함)
broker.id=1

# 리스너 설정
listeners=PLAINTEXT://localhost:9092
advertised.listeners=PLAINTEXT://localhost:9092

# 네트워크 스레드 수
num.network.threads=8

# I/O 스레드 수
num.io.threads=8

# 소켓 버퍼 크기
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600

############################# Log Basics #############################

# 로그 파일 저장 경로
log.dirs=/var/kafka-logs

# 토픽당 기본 파티션 수
num.partitions=3

# 복구 스레드 수
num.recovery.threads.per.data.dir=1

############################# Internal Topic Settings #############################

# 내부 토픽 설정
offsets.topic.replication.factor=2
transaction.state.log.replication.factor=2
transaction.state.log.min.isr=1

############################# Log Flush Policy #############################

# 메시지 플러시 정책 (성능 vs 내구성 트레이드오프)
# log.flush.interval.messages=10000
# log.flush.interval.ms=1000

############################# Log Retention Policy #############################

# 로그 보존 기간 (시간 기반)
log.retention.hours=168  # 7일

# 로그 보존 크기 (크기 기반)
# log.retention.bytes=1073741824

# 세그먼트 파일 크기
log.segment.bytes=1073741824  # 1GB

# 보존 정책 체크 주기
log.retention.check.interval.ms=300000

############################# Zookeeper #############################

# ZooKeeper 연결 설정
zookeeper.connect=localhost:2181

# ZooKeeper 연결 타임아웃
zookeeper.connection.timeout.ms=18000

############################# Group Coordinator Settings #############################

# 그룹 코디네이터 설정
group.initial.rebalance.delay.ms=3000

############################# Replication #############################

# 기본 복제 팩터
default.replication.factor=2

# 최소 동기화 복제본 수
min.insync.replicas=1

# 리더 선출 설정
unclean.leader.election.enable=false

# 복제 지연 시간
replica.lag.time.max.ms=30000

############################# Compression #############################

# 압축 타입 (none, gzip, snappy, lz4, zstd)
compression.type=producer

############################# Security #############################

# SSL 설정 (필요시 주석 해제)
# ssl.keystore.location=/var/ssl/kafka.server.keystore.jks
# ssl.keystore.password=password
# ssl.key.password=password
# ssl.truststore.location=/var/ssl/kafka.server.truststore.jks
# ssl.truststore.password=password

# SASL 설정 (필요시 주석 해제)
# sasl.enabled.mechanisms=PLAIN
# sasl.mechanism.inter.broker.protocol=PLAIN

############################# Metrics #############################

# 메트릭 리포터
metric.reporters=

# 메트릭 샘플 수
metrics.num.samples=2
metrics.sample.window.ms=30000

############################# Quota #############################

# 프로듀서 쿼터 (bytes/sec)
# quota.producer.default=10485760

# 컨슈머 쿼터 (bytes/sec)
# quota.consumer.default=10485760

############################# Transaction #############################

# 트랜잭션 타임아웃
transaction.max.timeout.ms=900000
transaction.state.log.load.buffer.size=5242880

############################# Performance Tuning #############################

# 배치 설정
replica.fetch.max.bytes=1048576
replica.fetch.wait.max.ms=500

# 네트워크 설정
replica.socket.timeout.ms=30000
controller.socket.timeout.ms=30000

# 백그라운드 스레드
background.threads=10

# 메시지 최대 크기
message.max.bytes=1048576
replica.fetch.max.bytes=1048576

############################# Monitoring #############################

# JMX 포트
# export JMX_PORT=9101

# 상태 체크
# kafka.metrics.polling.interval.secs=5

############################# Advanced #############################

# 자동 리더 밸런싱
auto.leader.rebalance.enable=true
leader.imbalance.per.broker.percentage=10
leader.imbalance.check.interval.seconds=300

# 컨트롤러 설정
controlled.shutdown.enable=true
controlled.shutdown.max.retries=3
controlled.shutdown.retry.backoff.ms=5000

# 파티션 재할당
# max.incremental.fetch.session.cache.slots=1000

############################# Rack Awareness #############################

# 랙 인식 설정 (데이터센터 환경)
# broker.rack=dc1-rack1